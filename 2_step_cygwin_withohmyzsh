trasnform script ps1 into .exe file : 

Transformer un script PowerShell en Ã‰xecutable
Tout dâ€™abord ouvrez en tant quâ€™administrateur lâ€™outil intÃ©grÃ© Ã  Windows Â« IExpress Â»


Pour commencer, sÃ©lectionner Â« Create new Self Extraction Directive file Â», puis sÃ©lectionnez Â« Create new Self Extraction Detective file Â». Enfin nommer le paquet comme bon vous semble, il nâ€™y a pas grande importance.




Pour les deux prochaines options, je laisse par defaut. Ensuite ajoutez tout dâ€™abord votre script dans les packaged files. Attention Ã  aussi ajouter les dÃ©penses de vos scripts sâ€™il y en a.




Second point Ã  faire attention dans Â« Install Program on Launch Â» insÃ©rez la commande suivante :

powershell.exe -ExecutionPolicy Bypass -File Filename.ps1
Veillez Ã  remplacer Â« Filename.ps1 Â» par le nom du script Ã  exÃ©cuter. Comme dit au dÃ©but de lâ€™article, le mien se nomme Â« change-hostname.ps1 Â» ce qui donne

powershell.exe -ExecutionPolicy Bypass -File change-hostname.ps1
Une fois la commande insÃ©rÃ©e, en continu Ã  laisser les options par dÃ©faut.




Ensuite dernier point important, renseigner oÃ¹ sera enregistrÃ© le package en .exe et cocher les deux cases du dessous.

Une option intÃ©ressante dans le cas du script avec lequel je fais le tuto, est de pouvoir demander Ã  lâ€™utilisateur de redÃ©marrer sa machine, en effet mon script Ã©tant fait pour renommer une machine, un redÃ©marrage est nÃ©cessaire.

Sur la page Â« Save Self Extraction Â» vous pouvez sauvegarder un rÃ©capitulatif au format .SED du package.




Pour la suite vous connaissez.. suivant, suivant, suivant â€¦â€¦



Ã€ la fin de lâ€™opÃ©ration, vous trouverez le .exe lÃ  oÃ¹ vous lâ€™avez enregistrÃ© ğŸ˜‰


Vous pouvez bien sur comme tout .exe, le lancer en tant quâ€™administrateur avec un clic droit !

ohmyzsh: https://medium.com/@alllexsm/how-to-install-z-shell-zsh-on-cygwin-dd9ee380d783

Script windows pour ouvrir cygwin avec ohmyzsh = C:\cygwin64\bin\mintty.exe -i /Cygwin-Terminal.ico /bin/zsh --login
